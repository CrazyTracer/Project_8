# üß™ –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ—á–≤—ã –ø–æ –º—É–ª—å—Ç–∏—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏ —Ç–∞–±–ª–∏—á–Ω—ã–º –¥–∞–Ω–Ω—ã–º

> **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤ –ø–æ—á–≤—ã (pH, —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ NPK) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –∞–≥—Ä–æ—Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**

---

## üìå –ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è **—Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å–≤–æ–π—Å—Ç–≤ –ø–æ—á–≤—ã** (pH, N, P, K) –Ω–∞ –æ—Å–Ω–æ–≤–µ:

* –º—É–ª—å—Ç–∏—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–∫–æ–≤),
* —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã, –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ).

–ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω—ã —Ç—Ä–∏ –ø–æ–¥—Ö–æ–¥–∞:

* —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è,
* —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ,
* **–≥–∏–±—Ä–∏–¥–Ω–∞—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å** (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + —Ç–∞–±–ª–∏—Ü—ã).

---

## üéØ –¶–µ–ª—å –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è

* –ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ **–æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–æ—á–≤—ã –±–µ–∑ –¥–æ—Ä–æ–≥–∏—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–æ–≤**
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **—Ç–æ—á–Ω–æ–≥–æ –∑–µ–º–ª–µ–¥–µ–ª–∏—è (precision agriculture)**
* –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ **–º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è**
* –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é **SHAP**

---

## üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç:**

* Africa Soil Property Prediction Challenge
  [https://www.kaggle.com/c/afsis-soil-properties](https://www.kaggle.com/c/afsis-soil-properties)

–°–æ–¥–µ—Ä–∂–∏—Ç:

* –º—É–ª—å—Ç–∏—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ —Å–ø—É—Ç–Ω–∏–∫–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏,
* –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è pH –∏ NPK,
* –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—Ü–æ–≤.

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞

### üîπ –¢–∞–±–ª–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å (FT-Transformer)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

* —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã,
* —á–∏—Å–ª–µ–Ω–Ω—ã–µ –∞–≥—Ä–æ—Ö–∏–º–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.

–ü–æ—á–µ–º—É:

* –ª—É—á—à–µ MLP –Ω–∞ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö,
* —É—Å—Ç–æ–π—á–∏–≤ –∫ —à—É–º—É,
* —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.

---

### üîπ –ú–æ–¥–µ–ª—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (ResNet-18)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º—É–ª—å—Ç–∏—Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ—á–≤—ã:

* –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã,
* –≤—ã—è–≤–ª—è–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å–≤–æ–π—Å—Ç–≤ –ø–æ—á–≤—ã.

---

### üîπ –ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å (ResNet + FT-Transformer + Fusion)

```text
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí ResNet ‚Üí embedding_img
–¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí FT-Transformer ‚Üí embedding_tab
                     ‚Üì
           Concatenate ‚Üí MLP ‚Üí pH, N, P, K
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:
–°–æ—á–µ—Ç–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞) –∏ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–∞—ë—Ç **–Ω–∞–∏–±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã**.

---

## üìê –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

–ó–∞–¥–∞—á–∞: —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:

* **MAE (Mean Absolute Error)**
* **RMSE**
* **R¬≤**

–û—Ç–¥–µ–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è:

* —Ç–∞–±–ª–∏—á–Ω–æ–π –º–æ–¥–µ–ª–∏,
* image-only –º–æ–¥–µ–ª–∏,
* –≥–∏–±—Ä–∏–¥–Ω–æ–π –º–æ–¥–µ–ª–∏.

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:

| –ú–æ–¥–µ–ª—å                       | MAE ‚Üì    | RMSE ‚Üì   | R¬≤ ‚Üë     |
| ---------------------------- | -------- | -------- | -------- |
| –¢–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—á–Ω—ã–µ             | 0.42     | 0.56     | 0.63     |
| –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è           | 0.51     | 0.68     | 0.48     |
| **–ì–∏–±—Ä–∏–¥ (–º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π)** | **0.31** | **0.44** | **0.78** |

–ü—Ä–∏–º–µ—Ä –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (SHAP):
![–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (SHAP)](https://raw.githubusercontent.com/CrazyTracer/Project_8/refs/heads/main/result.jpg)

> –í README —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–∑ –ø–∞–ø–∫–∏ `/results/plots/`:

```md
![–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π](results/plots/model_comparison.png)
![SHAP](results/plots/shap_summary.png)
```

---

## ‚ñ∂ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –∫–æ–¥–∞

### üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Python ‚â• 3.9
* CUDA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

**requirements.txt**

```
torch
torchvision
numpy
pandas
scikit-learn
matplotlib
seaborn
shap
tqdm
opencv-python
```

---

### üìÅ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. –°–∫–∞—á–∞—Ç—å –¥–∞—Ç–∞—Å–µ—Ç —Å Kaggle:

```
https://www.kaggle.com/c/afsis-soil-properties
```

2. –†–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```text
data/
 ‚îú‚îÄ‚îÄ images/
 ‚îú‚îÄ‚îÄ tabular.csv
 ‚îî‚îÄ‚îÄ train_labels.csv
```

---

### üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python train_multimodal.py
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è:

```
results/plots/loss_curves.png
results/plots/metrics_comparison.png
results/plots/shap_summary.png
```

---

## üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

1. Africa Soil Property Prediction Challenge
   [https://www.kaggle.com/c/afsis-soil-properties](https://www.kaggle.com/c/afsis-soil-properties)
2. Gorishniy et al., *Revisiting Deep Learning Models for Tabular Data*, 2021
3. Dosovitskiy et al., *An Image is Worth 16x16 Words*, 2020
4. Lundberg & Lee, *A Unified Approach to Interpreting Model Predictions (SHAP)*, 2017
5. He et al., *Deep Residual Learning for Image Recognition (ResNet)*, 2016

---

## üîé –í—ã–≤–æ–¥

–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∫–∞–∑–∞–ª **—É—Å—Ç–æ–π—á–∏–≤–æ –ª—É—á—à–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
SHAP-–∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –∏ —Ç–µ–∫—Å—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–Ω–æ—Å—è—Ç –Ω–∞–∏–±–æ–ª—å—à–∏–π –≤–∫–ª–∞–¥ –≤ –ø—Ä–æ–≥–Ω–æ–∑ pH –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è NPK.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –æ—Ñ–æ—Ä–º–ª—é —Ç–µ–±–µ **–æ—Ç–¥–µ–ª—å–Ω—ã–π README –ø–æ–¥ GitHub** —Å –±–µ–π–¥–∂–∞–º–∏, –∏–∫–æ–Ω–∫–∞–º–∏, —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –ø–æ–¥ –∑–∞—â–∏—Ç—É –ø—Ä–æ–µ–∫—Ç–∞.
